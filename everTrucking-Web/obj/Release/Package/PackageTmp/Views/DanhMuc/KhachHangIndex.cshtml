@model List<everTrucking_Web.Code.DTO.DanhMucKhachHang>


@{
    ViewBag.Title = "Trang Chủ";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    .table-bordered tr th {
        font-size: 14px;
        font-weight: 600 !important;
    }

    .title {
        align-items: center
    }
</style>

<div class="card shadow mb-4">
    <div class="card-header py-3">
        <div>
            <h6 class="m-0 font-weight-bold text-primary">
                DANH MỤC KHÁCH HÀNG
            </h6>
        </div>
    </div>
    <div class="card-header py-3 ">
        <div class="title d-flex justify-content-between mb-3">
            <div class="title d-flex justify-content-between">
                <h3>Khách hàng</h3>

                <div class="ml-5 form-check">
                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1">
                    <label class="form-check-label" for="flexRadioDefault1">
                        Tất cả
                    </label>
                </div>
                <div class=" ml-2 form-check">
                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1">
                    <label class="form-check-label" for="flexRadioDefault1">
                        Tổ chức
                    </label>
                </div>
                <div class="ml-2 form-check ">
                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault2" checked>
                    <label class="form-check-label" for="flexRadioDefault2">
                        Cá nhân
                    </label>
                </div>
            </div>
            <div>
                <button type="button" onclick="clearTextBox()" class="btn btn-primary" data-toggle="modal" data-target="#myModal2"> <i class="fa fa-plus"></i> Thêm mới</button>

            </div>
        </div>
    </div>
</div>




<div class="table-responsive">
    <table class="table table-bordered" id="table5">
        <thead>
            <tr>
                <th style="width:15%;">Mã khách hàng</th>
                <th>Tên khách hàng</th>
                <th style="width:15%;">Mã CS</th>

                <th style="width:10%;">Thao tác</th>
            </tr>
        </thead>
        <tbody class="tbody1">
        </tbody>
    </table>
   
</div>


<div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog  modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Thêm hàng hóa mới</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row" id="dvPartial">

                    <div class="col-6">
                        <div class="form-group">
                            <input id="ID" type="hidden" name="ID" />
                            <input id="IDDanhMucDonVi" type="hidden" name="IDDanhMucDonVi" class="form-control" />
                            <input id="IDDanhMucLoaiDoiTuong" type="hidden" name="IDDanhMucLoaiDoiTuong" class="form-control" />
                            <label>Mã :</label>
                            <input id="Ma" type="text" name="Ma" value="" class="form-control" />
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="form-group">
                            <label>Tên:</label>
                            <input id="Ten" type="text" name="Ten" value="" class="form-control" />
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="form-group">
                            <label>Tên EN:</label>
                            <input id="TenEN" type="text" name="TenEN" value="" class="form-control" />
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="form-group">
                            <label>Mã CS:</label>
                            <input id="MaCS" type="text" name="MaCS" value="" class="form-control" />
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="form-group">
                            <label>Địa chỉ:</label>
                            <input id="Diachi" type="text" name="DiaChi" value="" class="form-control" />
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="form-group">
                            <label>Mã số thuế:</label>
                            <input id="Masothue" type="text" name="MaSoThue" value="" class="form-control" />
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="form-group">
                            <label>Nhóm:</label>
                            <input id="Nhom" type="text" name="Nhom" value="" class="form-control" />
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="form-group">
                            <label>Vị trí:</label>
                            <input id="Vitri" type="text" name="ViTri" value="" class="form-control" />
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="form-group">
                            <input id="IDDanhMucNguoiSuDungCreate" type="hidden" name="IDDanhMucNguoiSuDungCreate" class="form-control" />
                            <input id="IDDanhMucNguoiSuDungEdit" type="hidden" name="IDDanhMucNguoiSuDungEdit" value="" class="form-control" />

                            <label>Ghi chú:</label>
                            <textarea id="Ghichu" type="text" name="GhiChu" value="" class="form-control"></textarea>
                        </div>
                    </div>


                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="btnAdd" class="btn btn-primary" onclick="Add()">Save changes</button>
                <button type="button" class="btn btn-primary" id="btnUpdate" style="display:none;" onclick="Update();">Update</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>






<script>
    $(document).ready(function () {
        loadData();
      
    });
    function loadData() {
        if ($.fn.dataTable.isDataTable('#table5')) {
            $('#table5').dataTable().fnDestroy();
        }

        $.ajax({
            url: "@Url.Action("List","DanhMuc")",
            type: "GET",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<tr>';
                    html += '<td>' + item.Ma + '</td>';
                    html += '<td>' + item.Ten + '</td>';
                    html += '<td >' + item.MaCS + '</td>';
                    html += '<td><a href="#" onclick="return getbyID(' + item.ID + ')"><i class="fa fa-pen fa-1x mr-1"></i></a> | <a href="#" onclick="Delele(' + item.ID + ')"><i class="fa fa-trash fa-1x ml-1"></i></a></td>';
                    html += '</tr>';
                });
                $('.tbody1').html(html);
              
                $('#table5').DataTable();
           

            },
            error: function (errorMesage) {
                alert(errorMesage.responseText);
            }
        });
    }

    //Add Data Function
    function Add() {
         var empObj = {
           // ID: $('#ID').val(),
            //IDDanhMucDonVi: $('#IDDanhMucDonVi').val(),
           // IDDanhMucLoaiDoiTuong: $('#IDDanhMucLoaiDoiTuong').val(),
            Ma: $('#Ma').val(),
            Ten: $('#Ten').val(),
            TenEN: $('#TenEN').val(),
            MaCS: $('#MaCS').val(),
            DiaChi: $('#Diachi').val(),
            MaSoThue: $('#Masothue').val(),
            Nhom: $('#Nhom').val(),
            ViTri: $('#Vitri').val(),
            GhiChu: $('#Ghichu').val(),
          //  IDDanhMucNguoiSuDungCreate: $('#IDDanhMucNguoiSuDungCreate').val(),
         //  IDDanhMucNguoiSuDungEdit: $('#IDDanhMucNguoiSuDungEdit').val(),
            CreateDate: $('#Ngaytao').val(),
            EditDate: $('#Ngaysua').val(),
        };
        var url = "@Url.Action("Add","DanhMuc")"
        $.ajax({
            url: url,
            data: JSON.stringify(empObj),
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                loadData();
             
                alert(result.Message);
              
                $('#myModal2').modal('hide');
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
        }

    function getbyID(EmpID) {

        $.ajax({
            url: "/DanhMuc/getbyID/" + EmpID,
            typr: "GET",
            contentType: "application/json;charset=UTF-8",
            dataType: "json",
            success: function (result) {
                $('#ID').val(result.ID);
                $('#IDDanhMucDonVi').val(result.IDDanhMucDonVi);
                $('#IDDanhMucLoaiDoiTuong').val(result.IDDanhMucLoaiDoiTuong);
                $('#Ma').val(result.Ma);
                $('#Ten').val(result.Ten);
                $('#TenEN').val(result.TenEN);
                $('#MaCS').val(result.MaCS);
                $('#Diachi').val(result.DiaChi);
                $('#Masothue').val(result.MaSoThue);
                $('#Nhom').val(result.Nhom);
                $('#Vitri').val(result.ViTri);
                $('#Ghichu').val(result.GhiChu);
                $('#IDDanhMucNguoiSuDungCreate').val(result.IDDanhMucNguoiSuDungCreate);
                $('#IDDanhMucNguoiSuDungEdit').val(result.IDDanhMucNguoiSuDungEdit);
                $('#Ngaytao').val(result.CreateDate);
                $('#Ngaysua').val(result.EditDate);
                $('#myModal2').modal('show');
                $('#btnUpdate').show();
                $('#btnAdd').hide();
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
        return false;
    }

     function Update() {

        var empObj = {
            ID: $('#ID').val(),
            IDDanhMucDonVi: $('#IDDanhMucDonVi').val(),
            IDDanhMucLoaiDoiTuong: $('#IDDanhMucLoaiDoiTuong').val(),
            Ma: $('#Ma').val(),
            Ten: $('#Ten').val(),
            TenEN: $('#TenEN').val(),
            MaCS: $('#MaCS').val(),
            DiaChi: $('#Diachi').val(),
            Masothue: $('#Masothue').val(),
            Nhom: $('#Nhom').val(),
            Vitri: $('#Vitri').val(),
            Ghichu: $('#Ghichu').val(),
            IDDanhMucNguoiSuDungCreate: $('#IDDanhMucNguoiSuDungCreate').val(),
            IDDanhMucNguoiSuDungEdit: $('#IDDanhMucNguoiSuDungEdit').val(),
           // CreateDate: $('#Ngaytao').val(),
            EditDate: $('#Ngaysua').val(),
        };
    var url = "@Url.Action("Update","DanhMuc")"
        $.ajax({
        url: url,
            data: JSON.stringify(empObj),
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
              
                loadData();
               
                alert(result.Message);
                $('#myModal2').modal('hide');
                ID: $('#ID').val("");
                IDDanhMucDonVi: $('#IDDanhMucDonVi').val("");
                IDDanhMucLoaiDoiTuong: $('#IDDanhMucLoaiDoiTuong').val("");
                Ma: $('#Ma').val("");
                Ten: $('#Ten').val();
                TenEN: $('#TenEN').val("");
                MaCS: $('#MaCS').val("");
                DiaChi: $('#Diachi').val("");
                MaSoThue: $('#Masothue').val("");
                Nhom: $('#Nhom').val("");
                ViTri: $('#Vitri').val("");
                GhiChu: $('#Ghichu').val("");
                IDDanhMucNguoiSuDungCreate: $('#IDDanhMucNguoiSuDungCreate').val("");
                IDDanhMucNguoiSuDungEdit: $('#IDDanhMucNguoiSuDungEdit').val("");
                //CreateDate: $('#Ngaytao').val("");
                EditDate: $('#Ngaysua').val("");

                },
            error: function (errormessage) {

                alert(errormessage.responseText);
        }
    });
        }

      function Delele(ID) {
    var ans = confirm("Bạn chắc chắn muốn xóa bản ghi này?");
    if (ans) {
        $.ajax({
            url: "/DanhMuc/Delete/" + ID,
            type: "POST",
            contentType: "application/json;charset=UTF-8",
            dataType: "json",
            success: function (result) {
                loadData();
                alert(result.Message);
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
    }
    }
    function clearTextBox() {
        $('#ID').val("");
        $('#IDDanhMucDonVi').val("");
        $('#IDDanhMucLoaiDoiTuong').val("");
        $('#Ma').val("");
        $('#Ten').val("");
        $('#TenEN').val("");
        $('#MaCS').val("");
        $('#Diachi').val("");
        $('#Masothue').val("");
        $('#Nhom').val("");
        $('#Vitri').val("");
        $('#Ghichu').val("");
        $('#btnUpdate').hide();
        $('#btnAdd').show();
        $('#IDDanhMucNguoiSuDungCreate').val("");
        $('#IDDanhMucNguoiSuDungEdit').val("");
        $('#Ngaytao').val("");
        $('#Ngaysua').val("")
    }
   

  
</script>

